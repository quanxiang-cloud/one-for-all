<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>page engine example</title>
  <script type="systemjs-importmap">
    {
      "imports": {
        "react": "https://ofapkg.pek3b.qingstor.com/react@17.0.1/react.17.0.1.min.js",
        "react-dom": "https://ofapkg.pek3b.qingstor.com/react-dom@17.0.1/react-dom.17.0.1.min.js",
        "rxjs": "https://ofapkg.pek3b.qingstor.com/@ofa/rxjs@7.4.0/rxjs.min.js",
        "rxjs/ajax": "https://ofapkg.pek3b.qingstor.com/@ofa/rxjs@7.4.0/rxjs-ajax.min.js",
        "rxjs/fetch": "https://ofapkg.pek3b.qingstor.com/@ofa/rxjs@7.4.0/rxjs-fetch.min.js",
        "rxjs/operators": "https://ofapkg.pek3b.qingstor.com/@ofa/rxjs@7.4.0/rxjs-operators.min.js",
        "rxjs/shared": "https://ofapkg.pek3b.qingstor.com/@ofa/rxjs@7.4.0/rxjs-shared.min.js",
        "rxjs/testing": "https://ofapkg.pek3b.qingstor.com/@ofa/rxjs@7.4.0/rxjs-testing.min.js",
        "rxjs/websocket": "https://ofapkg.pek3b.qingstor.com/@ofa/rxjs@7.4.0/rxjs-websocket.min.js",
        "react-jsx-parser": "https://ofapkg.pek3b.qingstor.com/@one-for-all/react-jsx-parser@1.29.0/index.min.js"
      }
    }
  </script>
  <script type="systemjs-importmap">
    {
      "imports": {
        "@one-for-all/page-engine-v2": "/pkg/page-engine-v2/dist/@one-for-all/page-engine-v2@latest/index.js",
        "@one-for-all/render-engine": "/pkg/render-engine/dist/@one-for-all/render-engine@latest/index.min.js",
        "page-engine-v2-components": "/dist/page-engine-v2-components/index.js",
        "ramda": "/vendors/ramda/dist/@one-for-all/ramda@latest/index.js",
        "@one-for-all/utils": "https://ofapkg.pek3b.qingstor.com/@one-for-all/utils@latest/index.min.js",
        "@one-for-all/ui": "https://ofapkg.pek3b.qingstor.com/@one-for-all/ui@latest/index.min.js"
      }
    }
  </script>
  <!-- <script src="/externals/system.min.js"></script> -->
  <script src="/externals/system.6.10.3.js"></script>
  <script defer src="/externals/adoptedStyleSheets.min.js"></script>
  <!-- <script src="/dist/core/systemjs-hooks/resolve.js"></script> -->
  <script>
    (function () {
      const endsWithFileExtension = /\/?\.[a-zA-Z]{2,}$/;
      const originalResolve = System.constructor.prototype.resolve;

      System.constructor.prototype.resolve = (id, parent) => {
        // apply original resolve to make sure importmaps are resolved first
        const url = originalResolve.apply(System, [id, parent]);
        // append .js file extension if url is missing a file extension
        return endsWithFileExtension.test(url) ? url : url + ".js";
      };

      System.import('react').then(React => window.React = React)

      // fixme: react throw process not defined
      if(!window.process){
        window.process={env: {NODE_ENV: 'development'}}
      }
    })();
  </script>
</head>
<body>
  <div id="app"></div>
  <script type="systemjs-module" src="/dist/page-engine-v2/index.js"></script>
</body>
</html>
